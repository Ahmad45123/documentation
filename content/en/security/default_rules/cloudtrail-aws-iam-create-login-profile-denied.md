---
aliases:
- fps-y8k-odm
- /security_monitoring/default_rules/fps-y8k-odm
- /security_monitoring/default_rules/cloudtrail-aws-iam-create-login-profile-denied
disable_edit: true
iaas: aws
integration_id: iam
kind: documentation
rule_category:
- Cloud SIEM (Log Detection)
scope: iam
security: attack
source: cloudtrail
tactic: TA0004-privilege-escalation
technique: T1078-valid-accounts
title: Possible Privilege Escalation via AWS IAM CreateLoginProfile
type: security_rules
---

## Goal
Detect a user attempting to create a password for a specified IAM user.

## Strategy
This rule allows you to monitor CloudTrail and detect if an attacker has attempted to create a password for an IAM user using the [`CreateLoginProfile`][1] API call.

## Triage and response
1. Determine if `{{@userIdentity.session_name}}` should have made a `{{@evt.name}}` API call.
2. If the API call was not made by the user:
  * Rotate user credentials.
  * Determine what other API calls were made by the user.
  * Remove any passwords generated by the user with the `aws-cli` command [delete-login-profile][2] or use the [AWS Console][3].
3. If the API call was made by the user:
  * Determine if the user should be performing this API call.
  * If No, see if other API calls were made by the user and determine if they warrant further investigation.

[1]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateLoginProfile.html
[2]: https://docs.aws.amazon.com/cli/latest/reference/iam/delete-login-profile.html
[3]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_admin-change-user.html#id_credentials_passwords_admin-change-user_console
