---
title: Set up Tracing on a Buddy pipelines
kind: documentation
aliases:
  - /continuous_integration/setup_pipelines/buddy
further_reading:
    - link: "/continuous_integration/pipelines"
      tag: "Documentation"
      text: "Explore Pipeline Execution Results and Performance"
    - link: "/continuous_integration/troubleshooting/"
      tag: "Documentation"
      text: "Troubleshooting CI"
---

{{< site-region region="gov" >}}
<div class="alert alert-warning">CI Visibility is not available in the selected site ({{< region-param key="dd_site_name" >}}) at this time.</div>
{{< /site-region >}}

## Configure the Datadog integration

The Datadog integration for [Buddy][1] works by using [webhooks][2] to send data to Datadog.

1. Go to **Integrations** in Buddy and click **New integration**
2. Search and select the **Webhook* integration and insert the following in the respective input fields
   * **Name**: `Datadog CI Visibility` or any other identifier name that you want to provide.
   * **Payload URL**<code>https://webhook-intake.{{< region-param key="dd_site" >}}/api/v2/webhook/?dd-api-key=<API_KEY></code> where `<API_KEY>` is your [Datadog API key][3]. 
   * **Trigger On Events**: Select `Pipeline run finished`.
   * **Enable In Projects**: Select `All` to enable the integration for all projects or `Selected` to tick a subset of projects.

2. Click **Save changes** to save the new webhook.

### Setting custom tags
To set custom tags to all the pipeline and job spans generated by the integration, add to the **Payload URL** a URL-encoded query parameter `tags`, with `key:value` pairs separated by commas. If a key:value pair contains any commas, surround it with quotes. For example, to add `key1:value1,"key2: value with , comma",key3:value3`, the following string would need to be appended to the **Webhook URL**:

`?tags=key1%3Avalue1%2C%22key2%3A+value+with+%2C+comma%22%2Ckey3%3Avalue3`

### Setting custom environment and service
To set a custom environment and serivce for pipelines using the integration include a URL-encoded query parameter
in the **Payload URL**. For the environment this query parameter is `env` and for the service it is `service`. 
For example to assign a custom environment `ci` and a service `buddy-pipelines` you would use the URL:

<code>https://webhook-intake.{{< region-param key="dd_site" >}}/api/v2/webhook/?dd-api-key=<API_KEY>&env=ci&service=buddy-pipelines</code>

### Including the repository

Buddy does not include their repository URL in their webhooks. To get the most out of CI Visibility
we recommend you add an action with name `[DD] GIT Reposository` that runs

```
echo "[DD] $BUDY_SCM_URL
```

Then CI Visibility will automatically recognize te git repository url and pipelines will show in the 
[Pipelines page][4]


## Visualize pipeline data in Datadog

The [Pipelines][4] and [Pipeline Executions][5] pages populate with data after the workflows finish.

**Note**: The Pipelines page shows data for only the default branch of each repository.


## Further reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: https://buddy.works
[2]: https://buddy.works/docs/integrations/webhooks
[3]: https://app.datadoghq.com/organization-settings/api-keys
[4]: https://app.datadoghq.com/ci/pipelines
[5]: https://app.datadoghq.com/ci/pipeline-executions
